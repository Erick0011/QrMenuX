{% extends 'admin/base.html' %}

{% block title %}Criar Restaurante{% endblock %}

{% block content %}
<table class="table table-bordered">
  <thead>
    <tr>
      <th>Restaurante</th>
      <th>Expira em</th>
      <th>Dias restantes</th>
      <th>Status</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for r in restaurants %}
      {% set sub = r.subscription %}
      {% set dias = sub.days_remaining() %}
      <tr style="background-color:
        {% if sub.has_expired() %}#f8d7da
        {% elif dias <= 5 %}#fff3cd
        {% else %}#d4edda{% endif %};">

        <td>{{ r.name }}</td>
        <td>{{ sub.end_date.strftime('%d/%m/%Y') }}</td>
        <td>{{ dias }}</td>
        <td>
          {% if sub.has_expired() %}
            <span class="badge bg-danger">Expirada</span>
          {% elif dias <= 5 %}
            <span class="badge bg-warning text-dark">Quase</span>
          {% else %}
            <span class="badge bg-success">Ativa</span>
          {% endif %}
        </td>
        <td>
            <div class="btn-group" role="group">
              <a href="{{ url_for('admin.extend_subscription', restaurant_id=r.id, days=7) }}" class="btn btn-sm btn-primary">+7 dias</a>
              <a href="{{ url_for('admin.extend_subscription', restaurant_id=r.id, months=1) }}" class="btn btn-sm btn-secondary">+1 mês</a>
              <a href="{{ url_for('admin.extend_subscription', restaurant_id=r.id, months=3) }}" class="btn btn-sm btn-dark">+3 meses</a>
              <a href="{{ url_for('admin.send_reminder', restaurant_id=r.id) }}" class="btn btn-sm btn-outline-secondary">Enviar lembrete</a>
            </div>


        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
